/**
 * Created by Vladi on 3/7/2015.
 * wrapper for http://morrisjs.github.io/morris.js/
 * version 1.1
 */
!function(){function t(t,e,i){function n(t,e){this.container=document.querySelector("#"+e.element),this.origData=e.data,this.xkey=e.xkey,this.origYKeys=e.ykeys,this.displayedYKeys=e.ykeys,this.labels=e.labels,this.morris=Morris[t](e)}if(!t||!e)return void console.log("Please make sure morris obj is correct");if(!Morris)return void console.log("Missing morris.js");var r=new n(t,e);return n.prototype.initSelectYKeys=function(){var t=r.origYKeys,e=document.createElement("div"),i=this.container.parentNode;e.className="buttonsContainer",e.setAttribute("data-parent-graph",this.container.id);for(var n in t){var o=document.createElement("input"),s=document.createElement("span");s.className="yKeyButton",t.hasOwnProperty(n)&&(o.setAttribute("type","checkbox"),o.checked=!0,o.style.cursor="pointer",s.style.cursor="pointer",o.setAttribute("data-key-name",t[n]),o.addEventListener("change",function(){var t=this;t.checked=!t.checked}),s.addEventListener("click",function(){var t=this.childNodes[0],e=t.getAttribute("data-key-name");e&&(r.toggleYKeys(e),t.checked=!t.checked)}),s.appendChild(o),s.appendChild(document.createTextNode("Display "+t[n])),e.appendChild(s))}i.insertBefore(e,this.container.nextSibling),this.buttonsContainer=e},n.prototype.show=function(){this.container.style.display="inline-block"},n.prototype.hide=function(){this.container.style.display="none"},n.prototype.getMorrisObj=function(){return this.morris},n.prototype.setData=function(t){t&&t.length>0&&(this.morris.setData(t),this.origData=t,this.setYKeys(this.origYKeys))},n.prototype.toggleYKeys=function(t){for(var e=this.displayedYKeys,i=[],n=0,r=e.length;r>n;n++)i.push(e[n]);for(var o=0,s=t.length;s>o;o++){var a=i.indexOf(t[o]);a>-1?delete i[a]:i.push(t[o])}this.displayedYKeys=i,this.setYKeys(i)},n.prototype.setYKeys=function(t){var e=this.filterData(this.origData,t);e&&e.length>0&&this.morris.setData(e)},n.prototype.filterData=function(t,e){var i=[];for(var n in t)if(t.hasOwnProperty(n)){var r=t[n],o={},s=!1;for(var a in r)if(r.hasOwnProperty(a))for(var c=0,h=e.length;h>c;c++)if(this.xkey===a||a===e[c]){o[a]=t[n][a],s=!0;break}s&&i.push(o)}return i},i&&r.initSelectYKeys(),r}var e={};window.MTA||(window.MTA=e),e.Line=function(e,i){return t("Line",e,i)},e.Bar=function(e,i){return t("Bar",e,i)},e.Donut=function(e){return t("Donut",e,!1)}}();