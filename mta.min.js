/**
 * Created by Vladi on 3/7/2015.
 * wrapper for http://morrisjs.github.io/morris.js/
 * version 1.1
 */
!function(){function e(e,t,i){function n(e,t){this.container=document.querySelector("#"+t.element),this.origData=t.data,this.xkey=t.xkey,this.origYKeys=t.ykeys,this.displayedYKeys=t.ykeys,this.labels=t.labels,this.morris=Morris[e](t)}if(!e||!t)return void console.log("Please make sure morris obj is correct");if(!Morris)return void console.log("Missing morris.js");var r=new n(e,t);return n.prototype.initSelectYKeys=function(){var e=r.origYKeys,t=document.createElement("div"),i=this.container.parentNode;t.className="buttonsContainer",t.setAttribute("data-parent-graph",this.container.id);for(var n in e){var s=document.createElement("input"),o=document.createElement("span");o.className="yKeyButton",e.hasOwnProperty(n)&&(s.setAttribute("type","checkbox"),s.checked=!0,s.style.cursor="pointer",o.style.cursor="pointer",s.setAttribute("data-key-name",e[n]),s.addEventListener("change",function(){var e=this;e.checked=!e.checked}),o.addEventListener("click",function(){var e=this.childNodes[0],t=e.getAttribute("data-key-name");t&&(r.toggleYKeys(t),e.checked=!e.checked)}),o.appendChild(s),o.appendChild(document.createTextNode("Display "+e[n])),t.appendChild(o))}i.insertBefore(t,this.container.nextSibling),this.buttonsContainer=t},n.prototype.show=function(){this.container.style.display="inline-block"},n.prototype.hide=function(){this.container.style.display="none"},n.prototype.setData=function(e){e&&e.length>0&&(this.morris.setData(e),this.origData=e,this.setYKeys(this.origYKeys))},n.prototype.toggleYKeys=function(e){for(var t=this.displayedYKeys,i=[],n=0,r=t.length;r>n;n++)i.push(t[n]);for(var s=0,o=e.length;o>s;s++){var a=i.indexOf(e[s]);a>-1?delete i[a]:i.push(e[s])}this.displayedYKeys=i,this.setYKeys(i)},n.prototype.setYKeys=function(e){var t=this.filterData(this.origData,e);t&&t.length>0&&this.morris.setData(t)},n.prototype.filterData=function(e,t){var i=[];for(var n in e)if(e.hasOwnProperty(n)){var r=e[n],s={},o=!1;for(var a in r)if(r.hasOwnProperty(a))for(var c=0,h=t.length;h>c;c++)if(this.xkey===a||a===t[c]){s[a]=e[n][a],o=!0;break}o&&i.push(s)}return i},i&&r.initSelectYKeys(),r}var t={};window.MTA||(window.MTA=t),t.Line=function(t,i){return e("Line",t,i)},t.Bar=function(t,i){return e("Bar",t,i)}}();